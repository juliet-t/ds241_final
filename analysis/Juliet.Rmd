---
title: "How the flow of traffic of cars correlates with bike share data"
output: html_notebook
---

- Look for areas that people do not use cars as much in 
- Put more bikes in the areas where there are less people commuting to work in cars
- Relation between motorized vehicles and bikes
- Parking spaces
- Last mile
- Where best to place bike stations 


# Load Approd Appropriate Packages

```{r}
library(knitr)
library(tidyverse)
library(janitor)
library(lubridate)
library(here) 
library(sf) 
library(tmap)
library(tidycensus)
```
Knitr is used for properly transforming the r notebook into an html file.
The tidyverse is used to tidy data using other packages within in such as dplyr.
The janitor packages is used to clean up the variable names from the data sets.
The lubridate library is used to work with date-times.
The here library is used to locate files on the computer to make it easier to load in the data sets.
The sf library is used to work with spatial data.
The tmap library is used to create interaactive maps.
The tidycensus data is used to get data from the U.S Census Bureau data via codes. 

# Read in the captial bike share data

```{r}
bikes = (read.csv(here("data_raw", "202309-capitalbikeshare-tripdata.csv"))) |> clean_names()
```

# Read in the Public Bike Rac

```{r}
racks = st_read((here("data_raw", "Public_Bike_Racks.geojson"))) |> clean_names() 
```
 
# Api Key to access the census data
```{r}
census_api_key("9fc5d3792d3a5e922287c3f4e9995118766d50a2")

```
# Loading in the codes that is linked to access the specific census data 
```{r}
v2018 = load_variables(2018, "acs5")
```

# Load the relevant data from the 2017-2021 Census Data for Washington DC

```{r}
df_censcus=get_acs(geography = "tract",
                  variables=c("vehicles"="B08141_001",
                              "population" = "B01001_001",
                               "public_transportion" = "B08006_008"),
                  state="DC",geometry=TRUE,year=2021) 
```
For this analysis, we will need the amount of vehiclces used in a specific location in Washington D.c., the population for each area in Washington D.C., and the usage of public transportation in those same areas. 

# Make sure our data frames plot

```{r}

plot(df_censcus)
plot(racks)

```

# Make each observation of vehicles, population, and public transportation into their own columns

```{r}

tmap_mode("view")

df_cens=df_censcus %>% 
  select(-moe) %>% 
  pivot_wider(names_from = "variable", 
              values_from = "estimate")|> 
  mutate(pub_pop = public_transportion / population,
         v_pop = vehicles / population)

```
# Read the Signed Bike Routes data into a spatial data frame. 

```{r}
bike_routes = st_read((here("data_raw", "Signed_Bike_Routes.geojson"))) |> clean_names() 
```

# Plot data
```{r}
df_cens_adj = df_cens |> st_transform(4326)
bike_routes = st_as_sf(bike_routes, crs=st_crs(df_cens_adj))

racks = st_as_sf(racks, crs=st_crs(df_cens_adj))
tm_shape(df_cens) +tm_polygons(c("pub_pop", "v_pop"), alpha=.5) + tm_shape(racks) +tm_symbols(size = 0.01, alpha = 0.5) +   
tm_shape(bike_routes) + tm_lines(col="blue",lwd=1,alpha= 1)
```



# Data Sources:

Public Bike Racks: https://opendata.dc.gov/explore?collection=Dataset&query=Public%20Bike%20Racks
Bike Share Data: https://capitalbikeshare.com/system-data
Signed Bike Routes: https://opendata.dc.gov/explore?collection=Dataset&query=Bike%20Routes


